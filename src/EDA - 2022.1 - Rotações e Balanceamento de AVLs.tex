\documentclass[11pt,twoside]{article}

\usepackage[
  a4paper,
  margin=1.5cm,
  includehead, includefoot
]{geometry}

\usepackage[utf8]{inputenc}
\usepackage[brazil,portuges]{babel}
\usepackage{csquotes}

% \usepackage[
%   backend=biber,
%   style=abnt,
%   language=auto,
% ]{bib>}

%   \addbibresource{../refs/referencias.bib}

\usepackage{soul}
\usepackage{xcolor}
\usepackage{framed}

\usepackage{tikz}

  \usetikzlibrary{shapes.geometric, positioning, decorations.pathreplacing, backgrounds, calc, arrows.meta, bending}

\usepackage{kpfonts}
\usepackage[T1]{fontenc}

\usepackage{tabularx}

  \newcolumntype{C}{>{\centering\arraybackslash}X}

\usepackage{graphicx}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{hhline}
\usepackage{booktabs}
\usepackage[inline]{enumitem}
\usepackage{xfrac}
\usepackage{mathtools}

  \newcommand{\Binary}{\ensuremath{\mathbb{B}}}
  \newcommand{\Natural}{\ensuremath{\mathbb{N}}}
  \newcommand{\Integer}{\ensuremath{\mathbb{Z}}}
  \newcommand{\Rational}{\ensuremath{\mathbb{Q}}}
  \newcommand{\Real}{\ensuremath{\mathbb{R}}}

  \DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
  \DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
  \DeclarePairedDelimiter{\abs}{\lvert}{\rvert}

\usepackage{amsthm}

  \newtheorem{proposition}{Proposição}[section]
  \theoremstyle{definition}
  \newtheorem{definition}{Definição}[section]

\usepackage{multicol}

  \newcommand{\finishcols}{\vfill\vphantom{.}}

\usepackage[portuguese,algoruled,vlined,noend]{algorithm2e}

  \SetKwInput{Algoritmo}{Algoritmo}
  \SetKw{Retorne}{retorne}
  \SetKwFor{Para}{para}{faça}{fimpara}
  \SetKw{Escreva}{escreva}
  \DontPrintSemicolon

\usepackage{hyperref}
\usepackage[brazil]{varioref}
\usepackage[brazilian]{cleveref}

  \def\disciplinacodigotext{QXD0115}
  \def\disciplinanometext{Estrutura de Dados Avançada}
  \def\semestretext{2022.1}
  \def\provatype{Notas de Aula}
  \def\provatitle{Rotações e Balanceamento de AVLs}
  \def\provatext{\provatype{} \ifx\provatype\empty {} \else {--} \fi \provatitle{}}
  \def\provacodtext{}
  \def\professorabbrv{Prof.}
  \def\professornometext{Arthur Araruna}

\usepackage{fancyhdr}

  \pagestyle{fancy}
  \fancyhead{}
  \lhead{\disciplinacodigotext}
  \chead{\provatext}
  \rhead{\semestretext}
  \fancyfoot{}
  \fancyfoot[LE,RO]{\colorbox{black!20}{\thepage}}

% * NOTE: Redefinição feita para evitar confusão com exponenciações.
\renewcommand{\thefootnote}{(\roman{footnote})}

\begin{document}
  \noindent
  \begin{minipage}{\textwidth}
    \begin{tabularx}{\textwidth}{cXc}
      \multirow{4}{*}{\includegraphics[height=1.8cm]{brasaoufc.pdf}} & {\bf UNIVERSIDADE FEDERAL DO CEARÁ}         & \multirow{3}{*}{} \\
                                                                     & {\bf Campus de Quixadá}                     &                   \\
                                                                     & \professorabbrv\enspace\professornometext   &                   \\
                                                                     & \disciplinacodigotext - \disciplinanometext & {}                \\
    \end{tabularx}
  \end{minipage}

  \part*{\provatitle}

    \section{Conceitos}

     Vamos relembrar o nossos conceitos que serão necessários para o resultado a ser demonstrado:

     \begin{definition}
       \emph{Rotação simples} (à direita ou à esquerda) é uma das transformações estruturais representadas a seguir, realizadas sobre a raiz de uma sub-árvore.

       \begin{figure}[h]
         \centering
         \caption{\label{fig:rot-simples}}
         \begin{tikzpicture}[transform shape, scale=0.8]
           \begin{scope}[nodes={draw, circle, minimum width=2.5ex}, sibling distance=5em, level distance=5ex]
             % Sub-árvore que representa *antes* da rotação simples à direita
             \draw node (p pre) {\( p \)}
             child {
                 node (u pre) {\( u \)}
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T1 pre) {\( T_1 \)}
                   }
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T2 pre) {\( T_2 \)}
                   }
               }
             child [child anchor=apex] {
                 node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T3 pre) {\( T_3 \) }
               }
             ;
           \end{scope}

           % Arco que chama atenção para operação de rotação ser à direita na raiz
           \draw [->, red!80] ([shift=(180:1.5em)]p pre.center) arc (180:20:1.5em);

           \begin{scope}[nodes={draw, circle, minimum width=2.5ex}, sibling distance=5em, level distance=5ex]
             % Sub-árvore que representa *antes* de rotação simples à esquerda
             \draw node [right=16em of p pre] (u post) {\( u \)}
             child [child anchor=apex] {
                 node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T1 post) {\( T_1 \) }
               }
             child {
                 node (p post) {\( p \)}
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T2 post) {\( T_2 \)}
                   }
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T3 post) {\( T_3 \)}
                   }
               }
             ;
           \end{scope}

           % Arco que chama atenção para operação de rotação ser à direita na raiz
           \draw [->, blue] ([shift=(0:1.5em)]u post.center) arc (0:160:1.5em);

           % Setas e legenda que destacam estado *após* cada rotação
           \begin{scope}
             \coordinate (center) at ($(current bounding box.north)!0.5!(current bounding box.south)$);
             \coordinate (rr begin) at ($(center)+(-3em,2em)$);
             \coordinate (lr begin) at ($(center)+(3em,-2em)$);

             \draw [-{Latex[fill=none]}, red!80, double, double distance=1.5pt] (rr begin) --  +(0:6em) node [draw=none, midway, label={above:{à direita (em \( p \))}}] {};
             \draw [-{Latex[fill=none]}, blue, double, double distance=1.5pt] (lr begin) -- +(180:6em) node [draw=none, midway, label={below:{à esquerda (em \( u \))}}] {};
           \end{scope}
         \end{tikzpicture}
       \end{figure}
     \end{definition}

     \begin{definition}
       \emph{Rotação dupla} (à direita ou à esquerda) é uma das transformações estruturais representadas a seguir, realizadas sobre a raiz de uma sub-árvore.

       \begin{figure}[h]
         \centering
         \caption{\label{fig:rot-dupla}}
         \begin{tikzpicture}[transform shape, scale=0.8]
           \begin{scope}[nodes={draw, circle, minimum width=2.5ex}, sibling distance=5em, level distance=5ex]
             % Sub-árvore que representa *antes* da rotação dupla à direita
             \draw node (p drr) {\( p \)}
             child [xshift=-0.5em] {
                 node (u drr) {\( u \)}
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T1 drr) {\( T_1 \)}
                   }
                 child {
                     node (v drr) {\( v \)}
                     child [child anchor=apex]{
                         node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T2 drr) {\( T_2 \)}}
                     child [child anchor=apex]{
                         node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T3 drr) {\( T_3 \)}}
                   }
               }
             child [xshift=0.5em, child anchor=apex] {
                 node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T4 drr) {\( T_4 \) }
               }
             ;
           \end{scope}

           % Arco que chama atenção para operação de rotação ser à direita na raiz
           \draw [-{>>[flex']}, red!80] ([shift=(180:1.5em)]p drr.center) arc (180:20:1.5em);


           \begin{scope}[nodes={draw, circle, minimum width=2.5ex}, sibling distance=3.5em, level distance=5ex]
             \draw node [right=17em of p drr] (v post) {\( v \)}
             child [xshift=-1.8em] {
                 node (u post) {\( u \)}
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T1 post) {\( T_1 \) }
                   }
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T2 post) {\( T_2 \) }
                   }
               }
             child [xshift=1.8em] {
                 node (p post) {\( p \)}
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T3 post) {\( T_3 \) }
                   }
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T4 post) {\( T_4 \) }
                   }
               }
             ;
           \end{scope}


           \begin{scope}[nodes={draw, circle, minimum width=2.5ex}, sibling distance=5em, level distance=5ex]
             % Sub-árvore que representa *antes* de rotação dupla à esquerda
             \draw node [right=17em of v post] (u dlr) {\( u \)}
             child [xshift=-0.5em, child anchor=apex] {
                 node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T1 dlr) {\( T_1 \) }
               }
             child [xshift=0.5em] {
                 node (p dlr) {\( p \)}
                 child {
                     node (v dlr) {\( v \)}
                     child [child anchor=apex] {
                         node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T2 dlr) {\( T_2 \)}
                       }
                     child [child anchor=apex] {
                         node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T3 dlr) {\( T_3 \)}
                       }
                   }
                 child [child anchor=apex] {
                     node [draw, isosceles triangle, shape border rotate=90, anchor=apex, minimum width=3em] (T4 dlr) {\( T_4 \)}
                   }
               }
             ;
           \end{scope}

           % Arco que chama atenção para operação de rotação ser à direita na raiz
           \draw [-{>>[flex']}, blue] ([shift=(0:1.5em)]u dlr.center) arc (0:160:1.5em);

           % Setas e legenda que destacam estado *após* cada rotação
           \begin{scope}
             \coordinate (left part) at ($(T4 drr)!0.5!(u post)$);
             \coordinate (right part) at ($(p post)!0.5!(T1 dlr)$);
             \coordinate (drr begin) at ($(left part)+(180:3em)$);
             \coordinate (dlr begin) at ($(right part)+(0:3em)$);

             \draw [-{Latex[fill=none]}, red!80, double, double distance=1.5pt] (drr begin) --  +(0:5em) node [draw=none, midway, label={above:{à direita (em \( p \))}}] {};
             \draw [-{Latex[fill=none]}, blue, double, double distance=1.5pt] (dlr begin) -- +(180:5em) node [draw=none, midway, label={above:{à esquerda (em \( u \))}}] {};
           \end{scope}
         \end{tikzpicture}
       \end{figure}
     \end{definition}

    \section{Rotações preservam propriedade ABB}

    \section{Rotações corrigem desbalanceamento}

    \section{Conclusão}


     %\part*{Apêndice}


     %\printbibliography

\end{document}